{
  "type": "page",
  "title": "",
  "body": [
    {
      "api": {
        "url": "/iotapi/amis/Device?where=%7B%22product%22:%22${productId}%22,%22name%22:%7B%22regex%22:%22${name}%22%7D,%22status%22:%22${status}%22%7D",
        "data": {
          "&": "$$",
          "count": "objectId",
          "order": "-createdAt"
        },
        "method": "get"
      },
      "card": {
        "body": [
        ],
        "type": "card",
        "header": {
          "title": "${name}",
          "avatar": "${basedata.ico}",
          "subTitle": "",
          "avatarClassName": "pull-left thumb b-3x m-r",
          "subTitlePlaceholder": ""
        },
        "actions": [
          {
            "type": "button",
            "label": "查看",
            "level": "dark",
            "dialog": {
              "body": [
                {
                  "tabs": [
                    {
                      "body": [
                        {
                          "id": "u:b0e3480d79a2",
                          "body": [
                            {
                              "id": "u:507be8aa7dc5",
                              "mode": "horizontal",
                              "name": "typeofweapon",
                              "size": "md",
                              "type": "select",
                              "label": "武器类型",
                              "options": [
                                {
                                  "label": "手枪",
                                  "value": "0"
                                },
                                {
                                  "label": "步枪",
                                  "value": "1"
                                },
                                {
                                  "label": "班用轻机枪",
                                  "value": "2"
                                },
                                {
                                  "label": "重机枪",
                                  "value": "3"
                                },
                                {
                                  "label": "狙击枪",
                                  "value": "4"
                                },
                                {
                                  "label": "头盔",
                                  "value": "16"
                                }
                              ]
                            },
                            {
                              "id": "u:e098a7be5f96",
                              "mode": "horizontal",
                              "name": "lengthoftraining",
                              "size": "md",
                              "type": "input-number",
                              "label": "训练时长"
                            },
                            {
                              "id": "u:070d5743c5e0",
                              "mode": "horizontal",
                              "name": "numberofbullets",
                              "size": "md",
                              "type": "input-number",
                              "label": "子弹数"
                            }
                          ],
                          "type": "form",
                          "title": "",
                          "visibleOn": "",
                          "affixFooter": false
                        }
                      ],
                      "title": "激光射击",
                      "visibleOn": "devaddr == 'shooting'",
                      "hash": "shooting"
                    },
                    {
                      "body": [
                        {
                          "id": "u:b0e3480d79a2",
                          "body": [
                            {
                              "id": "u:507be8aa7dc5",
                              "mode": "horizontal",
                              "name": "onlineequipment",
                              "size": "md",
                              "type": "select",
                              "label": "上线装备",
                              "options": [
                                {
                                  "label": "手枪",
                                  "value": "0"
                                },
                                {
                                  "label": "步枪",
                                  "value": "1"
                                },
                                {
                                  "label": "班用轻机枪",
                                  "value": "2"
                                },
                                {
                                  "label": "重机枪",
                                  "value": "3"
                                },
                                {
                                  "label": "狙击枪",
                                  "value": "4"
                                },
                                {
                                  "label": "头盔",
                                  "value": "16"
                                }
                              ]
                            },
                            {
                              "id": "u:4a32e0eaa861",
                              "mode": "horizontal",
                              "name": "onlineequipment",
                              "size": "md",
                              "type": "select",
                              "label": "装备配对状态",
                              "options": [
                                {
                                  "label": "已配对",
                                  "value": "0"
                                },
                                {
                                  "label": "未配对",
                                  "value": "1"
                                }
                              ]
                            },
                            {
                              "id": "u:b8703c043c50",
                              "mode": "horizontal",
                              "name": "battleplan",
                              "size": "md",
                              "type": "select",
                              "label": "对战方案",
                              "options": [
                                {
                                  "label": "手枪",
                                  "value": "0"
                                },
                                {
                                  "label": "步枪",
                                  "value": "1"
                                },
                                {
                                  "label": "班用轻机枪",
                                  "value": "2"
                                },
                                {
                                  "label": "重机枪",
                                  "value": "3"
                                },
                                {
                                  "label": "狙击枪",
                                  "value": "4"
                                },
                                {
                                  "label": "头盔",
                                  "value": "16"
                                }
                              ]
                            },
                            {
                              "id": "u:507be8aa7dc5",
                              "mode": "horizontal",
                              "name": "versusmode",
                              "size": "md",
                              "type": "select",
                              "label": "对战模式",
                              "options": [
                                {
                                  "label": "野战模式",
                                  "value": "0"
                                },
                                {
                                  "label": "巷战模式",
                                  "value": "1"
                                }
                              ]
                            },
                            {
                              "id": "u:f76d25321099",
                              "mode": "horizontal",
                              "name": "timeofplay",
                              "size": "lg",
                              "type": "input-date",
                              "label": "比赛时间",
                              "value": "",
                              "format": "X",
                              "maxDate": "",
                              "minDate": "",
                              "horizontal": null
                            },
                            {
                              "id": "u:070d5743c5e0",
                              "mode": "horizontal",
                              "name": "numberofrounds",
                              "size": "md",
                              "type": "input-number",
                              "label": "弹药数"
                            },
                            {
                              "id": "u:a640e72deae8",
                              "mode": "horizontal",
                              "name": "numberofbullets",
                              "size": "md",
                              "type": "input-number",
                              "label": "命中数"
                            },
                            {
                              "id": "u:b2f505b061be",
                              "mode": "horizontal",
                              "name": "isbyvoice",
                              "size": "md",
                              "type": "select",
                              "label": "是否语音播报",
                              "options": [
                                {
                                  "label": "是",
                                  "value": "0"
                                },
                                {
                                  "label": "否",
                                  "value": "1"
                                }
                              ],
                              "checkAll": false
                            }
                          ],
                          "type": "form",
                          "title": ""
                        }
                      ],
                      "title": "激光对抗",
                      "visibleOn": "devaddr == 'against'",
                      "hash": "against"
                    },
                    {
                      "body": [
                        {
                          "id": "u:b0e3480d79a2",
                          "body": [
                            {
                              "id": "u:070d5743c5e0",
                              "mode": "horizontal",
                              "name": "lengthofrun",
                              "size": "md",
                              "type": "input-number",
                              "label": "跑步长度"
                            },
                            {
                              "id": "u:a640e72deae8",
                              "mode": "horizontal",
                              "name": "numberofshots",
                              "size": "md",
                              "type": "input-number",
                              "label": "打靶次数"
                            },
                            {
                              "id": "u:a6f955927063",
                              "mode": "horizontal",
                              "name": "quantityofbullets",
                              "size": "md",
                              "type": "input-number",
                              "label": "子弹量"
                            }
                          ],
                          "type": "form",
                          "title": ""
                        }
                      ],
                      "title": "激光跑",
                      "visibleOn": "devaddr == 'run'",
                      "hash": "run"
                    },
                    {
                      "body": [
                        {
                          "id": "u:b0e3480d79a2",
                          "body": [
                            {
                              "id": "u:070d5743c5e0",
                              "mode": "horizontal",
                              "name": "highjump",
                              "size": "md",
                              "type": "input-number",
                              "label": "跳高成绩"
                            },
                            {
                              "id": "u:a640e72deae8",
                              "mode": "horizontal",
                              "name": "longjump",
                              "size": "md",
                              "type": "input-number",
                              "label": "跳远成绩"
                            }
                          ],
                          "type": "form",
                          "title": ""
                        }
                      ],
                      "title": "激光跳",
                      "visibleOn": "devaddr == 'jump'",
                      "hash": "jump"
                    },
                    {
                      "body": [
                        {
                          "id": "u:b0e3480d79a2",
                          "body": [
                            {
                              "id": "u:070d5743c5e0",
                              "mode": "horizontal",
                              "name": "scoreofthrowing",
                              "size": "md",
                              "type": "input-number",
                              "label": "投掷成绩"
                            }
                          ],
                          "type": "form",
                          "title": ""
                        }
                      ],
                      "title": "激光投",
                      "visibleOn": "devaddr == 'cast'",
                      "hash": "cast"
                    },
                    {
                      "body": [
                        {
                          "api": {
                            "url": "/iotapi/devicecard/${objectId}",
                            "method": "get",
                            "adaptor": "console.log('payload1111',payload)\r\nreturn {\r\n  data:{\r\n    items:payload.data\r\n  },\r\n  msg:'ok',\r\n  status:0\r\n}"
                          },
                          "card": {
                            "body": [
                              {
                                "tpl": "<span style='color:#0000ff;display:inline-block;margin-left:50px;font-size:24px'>${number}</span>",
                                "type": "tpl"
                              },
                              {
                                "name": "time",
                                "label": "时间"
                              }
                            ],
                            "header": {
                              "title": "$name",
                              "avatar": "<%= data.imgurl || \"https://dev.iotn2n.com/dgiot_file/amis/png/realtime.png\" %>",
                              "subTitle": "$unit",
                              "avatarClassName": "pull-left thumb b-3x m-r"
                            }
                          },
                          "mode": "cards",
                          "type": "crud",
                          "interval": 3000,
                          "messages": {
                          },
                          "draggable": true,
                          "silentPolling": true,
                          "perPageAvailable": [
                            10
                          ]
                        }
                      ],
                      "title": "数据面板"
                    },
                    {
                      "body": [
                        {
                          "body": [
                            {
                              "mode": "inline",
                              "name": "starttime",
                              "size": "md",
                              "type": "input-date",
                              "label": "开始日期",
                              "value": "-8day",
                              "format": "x",
                              "maxDate": "",
                              "minDate": ""
                            },
                            {
                              "mode": "inline",
                              "name": "endtime",
                              "size": "sm",
                              "type": "input-date",
                              "label": "结束日期",
                              "value": "now",
                              "format": "x",
                              "maxDate": "",
                              "minDate": ""
                            },
                            {
                              "name": "style",
                              "type": "select",
                              "label": "类型",
                              "value": "line",
                              "options": [
                                {
                                  "label": "折线图",
                                  "value": "line"
                                },
                                {
                                  "label": "柱状图",
                                  "value": "bar"
                                }
                              ],
                              "checkAll": false
                            },
                            {
                              "mode": "inline",
                              "name": "interval",
                              "size": "xs",
                              "type": "select",
                              "label": "间隔",
                              "value": "1h",
                              "options": [
                                {
                                  "label": "天",
                                  "value": "1d"
                                },
                                {
                                  "label": "时",
                                  "value": "1h"
                                },
                                {
                                  "label": "分",
                                  "value": "1m"
                                },
                                {
                                  "label": "秒",
                                  "value": "1s"
                                }
                              ],
                              "checkAll": false
                            },
                            {
                              "name": "limit",
                              "type": "input-text",
                              "addOn": {
                                "type": "submit",
                                "label": "搜索",
                                "level": "primary"
                              },
                              "label": "数量",
                              "value": "100"
                            }
                          ],
                          "mode": "inline",
                          "type": "form",
                          "title": "过滤条件",
                          "target": "chart1,chart2",
                          "actions": [
                          ],
                          "className": "m-b",
                          "submitOnInit": true,
                          "wrapWithPanel": false
                        },
                        {
                          "type": "divider"
                        },
                        {
                          "type": "grid",
                          "columns": [
                            {
                              "body": [
                                {
                                  "api": {
                                    "url": "/iotapi/echart/${objectId}",
                                    "data": {
                                      "&": "$$",
                                      "keys": "*",
                                      "limit": "${limit}",
                                      "style": "${style}",
                                      "endtime": "${endtime}",
                                      "function": "last",
                                      "interval": "${interval}",
                                      "starttime": "${starttime}"
                                    },
                                    "method": "get",
                                    "adaptor": "let rows = payload.chartData.rows\r\nlet columns = payload.chartData.columns\r\nlet xAxis = {}\r\nlet list = []\r\nfor(let i=0;i<columns.length;i++){\r\n  let items= []\r\n  for(let j = 0; j<rows.length; j++){\r\n    items.push(rows[j][columns[i]])\r\n  }  //获取图标x 轴 y轴数据\r\n  list.push(items)\r\n}\r\nxAxis.data = list[0]\r\nlet series = []\r\nfor(let i = 1 ;i<list.length;i++){\r\n  let item = {\r\n    name:columns[i],\r\n    type:api.query.style,\r\n    data:list[i],\r\n    symbol: \"none\", //去圆点\r\n  }\r\n  series.push(item)\r\n}\r\nlet data = {\r\n  xAxis,\r\n  series,\r\n  \r\n  \"tooltip\": {\r\n  \"trigger\": \"axis\",\r\n  \"axisPointer\": {\r\n    \"type\": \"cross\"\r\n  }\r\n},\r\n  \"yAxis\":{\r\n  \"type\": \"value\",\r\n  \"axisLabel\": {\r\n    \"formatter\": \"{value}\"\r\n  },\r\n  \"axisPointer\": {\r\n    \"snap\": true\r\n  }\r\n},\r\n  \"legend\": {\r\n    \"data\": [\r\n      \"湿度\",\r\n      \"温度\"\r\n    ]\r\n  },\r\n}\r\nconsole.log('payload',api,data)\r\nreturn {\r\n  data:data,\r\n  msg:'ok',\r\n  status:0\r\n}",
                                    "requestAdaptor": "return {\r\n  ...api\r\n}"
                                  },
                                  "name": "chart1",
                                  "type": "chart",
                                  "initFetch": false
                                }
                              ]
                            }
                          ],
                          "className": "m-t-lg"
                        }
                      ],
                      "title": "历史数据"
                    }
                  ],
                  "type": "tabs",
                  "tabsMode": "line",
                  "activeKey": "${devaddr}",
                  "closeOnEsc": false,
                  "mountOnEnter": false,
                  "unmountOnExit": true,
                  "closeOnOutside": false,
                  "showCloseButton": true
                }
              ],
              "size": "lg",
              "type": "dialog",
              "title": "",
              "actions": [
              ],
              "closeOnEsc": false,
              "closeOnOutside": false,
              "showCloseButton": true
            },
            "actionType": "dialog"
          },
          {
            "type": "button",
            "label": "编辑",
            "level": "success",
            "dialog": {
              "body": [
                {
                  "id": "u:539892ff6fb3",
                  "api": {
                    "url": "/iotapi/amis/Device/${objectId}",
                    "method": "put"
                  },
                  "body": [
                    {
                      "name": "name",
                      "type": "input-text",
                      "label": "名称"
                    },
                    {
                      "name": "devaddr",
                      "type": "input-text",
                      "label": "设备地址"
                    }
                  ],
                  "type": "form",
                  "title": "表单"
                }
              ],
              "size": "",
              "type": "dialog",
              "title": "编辑",
              "closeOnEsc": false,
              "closeOnOutside": false,
              "showCloseButton": true
            },
            "actionType": "dialog"
          },
          {
            "api": "delete:/iotapi/amis/Device/${objectId}",
            "type": "button",
            "label": "删除",
            "level": "danger",
            "actionType": "ajax",
            "confirmText": "确认要删除？"
          }
        ],
        "actionsCount": 5
      },
      "mode": "cards",
      "type": "crud",
      "draggable": true,
      "bulkActions": [
      ],
      "quickSaveApi": "/amis/api/sample/bulkUpdate",
      "defaultParams": {
        "perPage": 12
      },
      "quickSaveItemApi": "/amis/api/sample/$id"
    }
  ],
  "remark": "bla bla bla",
  "actions": [
  ],
  "perPageAvailable": [
    10
  ]
}
